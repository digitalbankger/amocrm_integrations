"use strict";(self["webpackChunkmy_vue_app"]=self["webpackChunkmy_vue_app"]||[]).push([[789],{6789:function(e,a,c){c.r(a),c.d(a,{default:function(){return J}});var t=c(3396);const s={class:"section animate"},n={class:"general d-flex jc-center"},i={class:"container d-flex m-col first-screen m-jc-center fd-row ai-end jc-center mp-tb-3"},d={class:"d-flex fd-column ai-center jc-center p-1 p-relative"},o={class:"container d-flex fd-column p-1 pm-0"},r={class:"d-flex fd-column jc-space ai-center z-index-1"},l=(0,t._)("section",{class:"d-flex fd-column ai-center jc-center p-1 p-relative"},[(0,t._)("div",{class:"d-flex fd-column p-1 ai-center z-index-1"})],-1);function f(e,a,c,f,b,m){const h=(0,t.up)("ArchiveItems"),p=(0,t.up)("StatisticsForm");return(0,t.wg)(),(0,t.iD)("div",s,[(0,t._)("div",n,[(0,t._)("div",i,[(0,t.Wm)(h)])]),(0,t._)("section",d,[(0,t._)("div",o,[(0,t._)("div",r,[(0,t.Wm)(p)])])]),l])}var b=c(4870),m=c(7139);const h=e=>((0,t.dD)("data-v-18a528f3"),e=e(),(0,t.Cn)(),e),p={class:"catalog"},u=h((()=>(0,t._)("h1",{class:"m-b-2"},"Сделки компании",-1))),I={class:"ads-list"},g={key:0},_=["src"],k={class:"ad-details"};function v(e,a,c,s,n,i){return(0,t.wg)(),(0,t.iD)("div",p,[u,(0,t._)("div",I,[0===s.deals.length?((0,t.wg)(),(0,t.iD)("div",g,"Нет доступных сделок")):(0,t.kq)("",!0),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(s.deals,(e=>((0,t.wg)(),(0,t.iD)("div",{key:e.id,class:"ad-item"},[(0,t._)("img",{src:"https://via.placeholder.com/150",alt:"Фото сделки",class:"ad-photo"},null,8,_),(0,t._)("div",k,[(0,t._)("h3",null,(0,m.zw)(e.name),1),(0,t._)("p",null,"Бюджет: "+(0,m.zw)(e.price)+" ₽",1)])])))),128))])])}const y={client_id:"a5a49978-60b4-45e5-9fac-8af6887d9602",client_secret:"1pWapg0P0mww8j08HCOo4nMpsgg69WGFB36UppRUY8J5lsCAveSFS0UTxatFTt8X",grant_type:"authorization_code",refresh_token:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6IjY1ZjJjY2FjMTgzNWIxYjk1NzA3N2VjM2ZlNDhiOWI0YjZhMmVmZTZiYzllMjViNDBiODg4MmI5MDAwNmVmMjFmZjViNmY2YzllY2RiZGYxIn0.eyJhdWQiOiJhNWE0OTk3OC02MGI0LTQ1ZTUtOWZhYy04YWY2ODg3ZDk2MDIiLCJqdGkiOiI2NWYyY2NhYzE4MzViMWI5NTcwNzdlYzNmZTQ4YjliNGI2YTJlZmU2YmM5ZTI1YjQwYjg4ODJiOTAwMDZlZjIxZmY1YjZmNmM5ZWNkYmRmMSIsImlhdCI6MTcyNTg4NjI1MiwibmJmIjoxNzI1ODg2MjUyLCJleHAiOjE3MjYwMTI4MDAsInN1YiI6IjExNDkyNDU4IiwiZ3JhbnRfdHlwZSI6IiIsImFjY291bnRfaWQiOjMxOTM5ODk0LCJiYXNlX2RvbWFpbiI6ImFtb2NybS5ydSIsInZlcnNpb24iOjIsInNjb3BlcyI6WyJjcm0iLCJmaWxlcyIsImZpbGVzX2RlbGV0ZSIsIm5vdGlmaWNhdGlvbnMiLCJwdXNoX25vdGlmaWNhdGlvbnMiXSwiaGFzaF91dWlkIjoiNzkxOGUxNGItOTgwNS00MTZiLTkwMGUtY2I0YTZhNGE3ZThlIiwiYXBpX2RvbWFpbiI6ImFwaS1iLmFtb2NybS5ydSJ9.U6FdcvJlQuSkgkaKgswpMOEPSLxhs2CYqyeP7zIOqWTtH9mztt40pp1IJ6WVEm-GiyRg_WbWjtH8FiBda3R4aq7TR3upPresJk3diWE-eOULtL1MR-Kt38tSr_aEzEIJgZHZMU2G6LIZhn165mSB7l85boJtjWyTZ946M42Y-YisuhmZRVifl90ZfzPTTvKfyTHx4ES1Q_pNK-IyRx5j0EdAN0lc7iof72sN6QXoDSZtKMzQyUBXN3WQB4vASLh0bS8jNyC6NaKqgjNCeArDn3t6J49UKmNM15zf7NGqFwmUUnER39SiEMduI3oXULFdOGqyyqW-teowcye0E01eLg",redirect_uri:"https://digitalbankger.github.io/amocrm_integrations/#/",code:"def502000c0188e6356bc091d6a8d394f941f237050520212a4382f1890b59eeed8c199c0a9889442ea61e84d4b426dc691d883dbcb9d7f5b3edfefa50939b07f8b35980a298b31d2423eaee37325a58ab804c6a969d37353122c295510c97cf597717d4d75b24b772caa6928531b696ced83643bf41771ad7c7c2aa28482558c0f6b74e9ca54b5d23a77c5d60203a1a0c23e720c904d5a6cbe0fdbb70a1d549a5364b3474317522da5903e734dfc737e899355fb64006d3cf30c9de362bb94951134cf8e258f4b9206f00f0a749407488a7654e043d066e1c1daa1da1d53a16116080fca1a2333daa94fa3877097455283dd148b36f05d9be33bfbf012fc8c5f8aeb902fe9d1acd0859f6573ca30f585697f1264fc7787b559b21ce5a33176bbd8172df09a35f534a8b39c50a23f5bea3b498aae9333c6cb24c984bfe123bd519cd556d8aec77b09d33d4e570a7cc37bd3560be211d037003c8cf96d6ed25a01d550b1042d4cc502956fe10965fa74bda851ff0878d4fabb5099f20d2fb8dc87f16aa109d7bb9c664a6a88b74e62f284447328698f50ee20076c585114984e8bbeed4e52515c3ee9e97a228ce315091e7b2ed5aa4f537ce3bf2fb38f75e212fccd4fcc335af86d64157527e00294d82d823c38e3c478134d68f2be64c0043b496537ada9b1d23b9d6627c49097b2e9d863e86dfb3105499ccb1e5533e549d5622406edd63bbd37493772c",async fetchAccessToken(){const e=await fetch("https://cors-anywhere.herokuapp.com/https://bkmzenbkmzen.amocrm.ru/oauth2/access_token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:this.client_id,client_secret:this.client_secret,grant_type:"authorization_code",code:this.code,redirect_uri:"https://digitalbankger.github.io/amocrm_integrations/#/"})});if(!e.ok)throw new Error("Failed to get access token");const a=await e.json();return this.tokenInfo={access_token:a.access_token,refresh_token:a.refresh_token,expires_in:a.expires_in,token_type:a.token_type},localStorage.setItem("access_token",a.access_token),localStorage.setItem("refresh_token",a.refresh_token),a.access_token},getStoredAccessToken(){return localStorage.getItem("access_token")},async ensureTokenIsValid(){const e=this.getStoredAccessToken();return e||await this.fetchAccessToken()}};var N=y;const j="https://cors-anywhere.herokuapp.com/https://bkmzenbkmzen.amocrm.ru/api";async function w(e,a={}){const c=await N.ensureTokenIsValid();a.headers={...a.headers,Authorization:`Bearer ${c}`,"Content-Type":"application/json"};const t=await fetch(`${j}${e}`,a);if(!t.ok)throw new Error(`Ошибка: ${t.statusText}`);const s=t.headers.get("Content-Type");return s&&s.includes("application/json")?await t.json():await t.text()}function T(){return w("/v4/leads").then((e=>(console.log("Ответ от API (сделки):",e),e))).catch((e=>{console.error("Ошибка при получении сделок:",e)}))}function S(e){return w(`/v4/leads/${e}`)}function Y(){return{fetchDeals:T,fetchDealById:S}}var M={setup(){const e=(0,b.iH)([]),a=async()=>{try{const a=localStorage.getItem("cachedDeals");if(a)e.value=JSON.parse(a),console.log("Загружаем сделки из кэша:",e.value);else{console.log("Отправляю запрос на получение сделок...");const a=await Y().fetchDeals();a&&a._embedded&&Array.isArray(a._embedded.leads)?(e.value=a._embedded.leads,console.log("Сделки после присваивания:",e.value),localStorage.setItem("cachedDeals",JSON.stringify(e.value))):console.error("Сделки не найдены в ответе API или структура ответа изменилась.")}}catch(a){console.error("Ошибка загрузки сделок:",a)}};return(0,t.bv)(a),{deals:e}}},Z=c(89);const x=(0,Z.Z)(M,[["render",v],["__scopeId","data-v-18a528f3"]]);var z=x,O={components:{ArchiveItems:z},setup(){const e=(0,b.iH)(!1),a=(0,b.iH)(""),c=c=>{e.value=!0,a.value=c},t=()=>{e.value=!1,a.value=""};return{isLightboxOpen:e,lightboxImageSrc:a,openLightbox:c,closeLightbox:t}}};const W=(0,Z.Z)(O,[["render",f]]);var J=W}}]);
//# sourceMappingURL=789.2fc0fab7.js.map