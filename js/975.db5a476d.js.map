{"version":3,"file":"js/975.db5a476d.js","mappings":"uLACOA,MAAM,mB,GACJA,MAAM,4B,GACJA,MAAM,mF,GAMJA,MAAM,uD,GACRA,MAAM,uC,GACJA,MAAM,iD,GAOfC,EAAAA,EAAAA,GAKU,WALDD,MAAM,uDAAqD,EAElEC,EAAAA,EAAAA,GAEM,OAFDD,MAAM,+CAA0C,G,wGAnBzDE,EAAAA,EAAAA,IAwBM,MAxBNC,EAwBM,EAvBJF,EAAAA,EAAAA,GAIM,MAJNG,EAIM,EAHJH,EAAAA,EAAAA,GAEM,MAFNI,EAEM,EADJC,EAAAA,EAAAA,IAAgBC,QAKpBN,EAAAA,EAAAA,GAMU,UANVO,EAMU,EALRP,EAAAA,EAAAA,GAIM,MAJNQ,EAIM,EAHJR,EAAAA,EAAAA,GAEM,MAFNS,EAEM,EADJJ,EAAAA,EAAAA,IAAkBK,SAMxBC,G,wFCjBGZ,MAAM,W,UACTC,EAAAA,EAAAA,GAAsC,MAAlCD,MAAM,SAAQ,mBAAe,K,GAE5BA,MAAM,Y,uBAIFA,MAAM,c,0CAPjBE,EAAAA,EAAAA,IAaM,MAbNC,EAaM,CAZJC,GAEAH,EAAAA,EAAAA,GASM,MATNI,EASM,CARwB,IAAjBQ,EAAAC,MAAMC,SAAM,WAAvBb,EAAAA,EAAAA,IAAyD,MAAAM,EAA1B,0BAAoB,8BACnDN,EAAAA,EAAAA,IAMMc,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IANcJ,EAAAC,OAARI,K,WAAZhB,EAAAA,EAAAA,IAMM,OANsBiB,IAAKD,EAAKE,GAAIpB,MAAM,W,EAC9CC,EAAAA,EAAAA,GAAmF,OAA7EoB,IAAK,kCAAmCC,IAAI,cAActB,MAAM,Y,WACtEC,EAAAA,EAAAA,GAGM,MAHNS,EAGM,EAFJT,EAAAA,EAAAA,GAAwB,WAAAsB,EAAAA,EAAAA,IAAjBL,EAAKM,MAAI,IAChBvB,EAAAA,EAAAA,GAAiC,SAA9B,YAAQsB,EAAAA,EAAAA,IAAGL,EAAKO,OAAQ,KAAE,U,UCVvC,MAAMC,EAAe,CACjBC,UAAW,uCACXC,cAAe,mEACfC,WAAY,qBACZC,cAAe,8jCACfC,aAAc,0DACdC,KAAM,yhCAGN,sBAAMC,GACJ,MAAMC,QAAiBC,MAAM,yFAA0F,CACrHC,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAU,CACnBb,UAAWc,KAAKd,UAChBC,cAAea,KAAKb,cACpBC,WAAY,qBACZG,KAAMS,KAAKT,KACXD,aAAc,8DAIlB,IAAKG,EAASQ,GACZ,MAAM,IAAIC,MAAM,8BAGlB,MAAMC,QAAaV,EAASW,OAY5B,OAVAJ,KAAKK,UAAY,CACfC,aAAcH,EAAKG,aACnBjB,cAAec,EAAKd,cACpBkB,WAAYJ,EAAKI,WACjBC,WAAYL,EAAKK,YAGnBC,aAAaC,QAAQ,eAAgBP,EAAKG,cAC1CG,aAAaC,QAAQ,gBAAiBP,EAAKd,eAEpCc,EAAKG,YACd,EAEAK,oBAAAA,GACE,OAAOF,aAAaG,QAAQ,eAC9B,EAEA,wBAAMC,GACJ,MAAMC,EAAQd,KAAKW,uBACnB,OAAKG,SACUd,KAAKR,kBAItB,GAGJ,QCvDA,MAAMuB,EAAU,yEAEhBC,eAAeC,EAAUC,EAAUC,EAAU,CAAC,GAC5C,MAAMC,QAAoBnC,EAAa4B,qBAEvCM,EAAQvB,QAAU,IACbuB,EAAQvB,QACXyB,cAAgB,UAASD,IACzB,eAAgB,oBAGlB,MAAM3B,QAAiBC,MAAO,GAAEqB,IAAUG,IAAYC,GAEtD,IAAK1B,EAASQ,GACZ,MAAM,IAAIC,MAAO,WAAUT,EAAS6B,cAGtC,MAAMC,EAAc9B,EAASG,QAAQ4B,IAAI,gBAEzC,OAAID,GAAeA,EAAYE,SAAS,0BACzBhC,EAASW,aAETX,EAASiC,MAE1B,CAGO,SAASC,IACd,OAAOV,EAAW,aACfW,MAAKnC,IACJoC,QAAQC,IAAI,yBAA0BrC,GAC/BA,KAERsC,OAAMC,IACLH,QAAQG,MAAM,+BAAgCA,EAAM,GAE1D,CAGO,SAASC,EAActD,GAC5B,OAAOsC,EAAW,aAAYtC,IAChC,CAEO,SAASuD,IACd,MAAO,CACLP,aACAM,gBAEJ,CF7BA,OACEE,KAAAA,GACE,MAAM9D,GAAQ+D,EAAAA,EAAAA,IAAI,KACZ,WAAET,GAAeO,IAEjBG,EAAarB,UACjB,IACE,MAAMvB,QAAiBkC,IACnBlC,EAAS6C,WAAa7C,EAAS6C,UAAUC,OAC3ClE,EAAMmE,MAAQ/C,EAAS6C,UAAUC,MACjCV,QAAQC,IAAI,UAAWzD,EAAMmE,QAE7BX,QAAQG,MAAM,iCAElB,CAAE,MAAOA,GACPH,QAAQG,MAAM,0BAA2BA,EAC3C,GAKF,OAFAS,EAAAA,EAAAA,IAAUJ,GAEH,CACLhE,QAEJ,G,QGtCF,MAAMqE,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAAS,GAAQ,CAAC,YAAY,qBAEzF,QJwBA,GACEC,WAAY,CAEVC,aAAYA,GAEdT,KAAAA,GAEE,MAAMU,GAAiBT,EAAAA,EAAAA,KAAI,GACrBU,GAAmBV,EAAAA,EAAAA,IAAI,IAEvBW,EAAgBC,IACpBH,EAAeL,OAAQ,EACvBM,EAAiBN,MAAQQ,CAAQ,EAG7BC,EAAgBA,KACpBJ,EAAeL,OAAQ,EACvBM,EAAiBN,MAAQ,EAAE,EAG7B,MAAO,CACLK,iBACAC,mBACAC,eACAE,gBAEJ,GKtDF,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://my-vue-app/./src/components/CatalogItems.vue","webpack://my-vue-app/./src/components/ui/ArchiveItems.vue","webpack://my-vue-app/./src/services/tokenService.js","webpack://my-vue-app/./src/services/api/api.js","webpack://my-vue-app/./src/components/ui/ArchiveItems.vue?329d","webpack://my-vue-app/./src/components/CatalogItems.vue?cc18"],"sourcesContent":["<template>\r\n  <div class=\"section animate\">\r\n    <div class=\"general d-flex jc-center\">\r\n      <div class=\"container d-flex m-col first-screen m-jc-center fd-row ai-end jc-center mp-tb-3\">\r\n        <ArchiveItems />\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Каталог -->\r\n    <section class=\"d-flex fd-column ai-center jc-center p-1 p-relative\">\r\n      <div class=\"container d-flex fd-column p-1 pm-0\">\r\n        <div class=\"d-flex fd-column jc-space ai-center z-index-1\">\r\n          <StatisticsForm />\r\n        </div>\r\n      </div>\r\n    </section>\r\n\r\n    <!-- Лайтбокс с созданием элемента -->\r\n    <section class=\"d-flex fd-column ai-center jc-center p-1 p-relative\">\r\n\r\n      <div class=\"d-flex fd-column p-1 ai-center z-index-1\">\r\n        <!-- <AddItem @open-lightbox=\"openLightbox\"/> -->\r\n      </div>\r\n    </section>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue';\r\nimport ArchiveItems from '@/components/ui/ArchiveItems.vue';\r\n// import AddItem from '@/components/AddItem.vue';\r\n\r\nexport default {\r\n  components: {\r\n    // AddItem,\r\n    ArchiveItems,\r\n  },\r\n  setup() {\r\n\r\n    const isLightboxOpen = ref(false);\r\n    const lightboxImageSrc = ref('');\r\n\r\n    const openLightbox = (imageSrc) => {\r\n      isLightboxOpen.value = true;\r\n      lightboxImageSrc.value = imageSrc;\r\n    };\r\n\r\n    const closeLightbox = () => {\r\n      isLightboxOpen.value = false;\r\n      lightboxImageSrc.value = '';\r\n    };\r\n\r\n    return { \r\n      isLightboxOpen,\r\n      lightboxImageSrc,\r\n      openLightbox,\r\n      closeLightbox\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>","<template>\r\n  <div class=\"catalog\">\r\n    <h1 class=\"m-b-2\">Сделки компании</h1>\r\n\r\n    <div class=\"ads-list\">\r\n      <div v-if=\"deals.length === 0\">Нет доступных сделок</div>\r\n      <div v-for=\"deal in deals\" :key=\"deal.id\" class=\"ad-item\">\r\n        <img :src=\"'https://via.placeholder.com/150'\" alt=\"Фото сделки\" class=\"ad-photo\" />\r\n        <div class=\"ad-details\">\r\n          <h3>{{ deal.name }}</h3>\r\n          <p>Бюджет: {{ deal.price }} ₽</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted } from 'vue';\r\nimport { useApi } from '@/services/api/api.js';\r\n\r\nexport default {\r\n  setup() {\r\n    const deals = ref([]);\r\n    const { fetchDeals } = useApi();\r\n\r\n    const fetchItems = async () => {\r\n      try {\r\n        const response = await fetchDeals();\r\n        if (response._embedded && response._embedded.leads) {\r\n          deals.value = response._embedded.leads;\r\n          console.log(\"Сделки:\", deals.value);\r\n        } else {\r\n          console.error(\"Сделки не найдены в ответе API\");\r\n        }\r\n      } catch (error) {\r\n        console.error('Ошибка загрузки сделок:', error);\r\n      }\r\n    };\r\n\r\n    onMounted(fetchItems); \r\n\r\n    return {\r\n      deals, \r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.catalog {\r\n  max-width: 1200px;\r\n  margin: 40px auto;\r\n  padding: 20px;\r\n}\r\n\r\n.ads-list {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\r\n  gap: 20px;\r\n}\r\n\r\n.ad-item {\r\n  border: 1px solid #ccc;\r\n  padding: 15px;\r\n  text-align: center;\r\n  border-radius: 10px;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.ad-photo {\r\n  width: 100%;\r\n  height: 150px;\r\n  object-fit: cover;\r\n  border-radius: 8px;\r\n}\r\n\r\n.ad-details {\r\n  margin-top: 10px;\r\n}\r\n</style>\r\n","const tokenService = {\r\n    client_id: 'a5a49978-60b4-45e5-9fac-8af6887d9602',\r\n    client_secret: '1pWapg0P0mww8j08HCOo4nMpsgg69WGFB36UppRUY8J5lsCAveSFS0UTxatFTt8X',\r\n    grant_type: 'authorization_code',\r\n    refresh_token: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6IjY1ZjJjY2FjMTgzNWIxYjk1NzA3N2VjM2ZlNDhiOWI0YjZhMmVmZTZiYzllMjViNDBiODg4MmI5MDAwNmVmMjFmZjViNmY2YzllY2RiZGYxIn0.eyJhdWQiOiJhNWE0OTk3OC02MGI0LTQ1ZTUtOWZhYy04YWY2ODg3ZDk2MDIiLCJqdGkiOiI2NWYyY2NhYzE4MzViMWI5NTcwNzdlYzNmZTQ4YjliNGI2YTJlZmU2YmM5ZTI1YjQwYjg4ODJiOTAwMDZlZjIxZmY1YjZmNmM5ZWNkYmRmMSIsImlhdCI6MTcyNTg4NjI1MiwibmJmIjoxNzI1ODg2MjUyLCJleHAiOjE3MjYwMTI4MDAsInN1YiI6IjExNDkyNDU4IiwiZ3JhbnRfdHlwZSI6IiIsImFjY291bnRfaWQiOjMxOTM5ODk0LCJiYXNlX2RvbWFpbiI6ImFtb2NybS5ydSIsInZlcnNpb24iOjIsInNjb3BlcyI6WyJjcm0iLCJmaWxlcyIsImZpbGVzX2RlbGV0ZSIsIm5vdGlmaWNhdGlvbnMiLCJwdXNoX25vdGlmaWNhdGlvbnMiXSwiaGFzaF91dWlkIjoiNzkxOGUxNGItOTgwNS00MTZiLTkwMGUtY2I0YTZhNGE3ZThlIiwiYXBpX2RvbWFpbiI6ImFwaS1iLmFtb2NybS5ydSJ9.U6FdcvJlQuSkgkaKgswpMOEPSLxhs2CYqyeP7zIOqWTtH9mztt40pp1IJ6WVEm-GiyRg_WbWjtH8FiBda3R4aq7TR3upPresJk3diWE-eOULtL1MR-Kt38tSr_aEzEIJgZHZMU2G6LIZhn165mSB7l85boJtjWyTZ946M42Y-YisuhmZRVifl90ZfzPTTvKfyTHx4ES1Q_pNK-IyRx5j0EdAN0lc7iof72sN6QXoDSZtKMzQyUBXN3WQB4vASLh0bS8jNyC6NaKqgjNCeArDn3t6J49UKmNM15zf7NGqFwmUUnER39SiEMduI3oXULFdOGqyyqW-teowcye0E01eLg',\r\n    redirect_uri: 'https://digitalbankger.github.io/amocrm_integrations/#/',\r\n    code: 'def502000c0188e6356bc091d6a8d394f941f237050520212a4382f1890b59eeed8c199c0a9889442ea61e84d4b426dc691d883dbcb9d7f5b3edfefa50939b07f8b35980a298b31d2423eaee37325a58ab804c6a969d37353122c295510c97cf597717d4d75b24b772caa6928531b696ced83643bf41771ad7c7c2aa28482558c0f6b74e9ca54b5d23a77c5d60203a1a0c23e720c904d5a6cbe0fdbb70a1d549a5364b3474317522da5903e734dfc737e899355fb64006d3cf30c9de362bb94951134cf8e258f4b9206f00f0a749407488a7654e043d066e1c1daa1da1d53a16116080fca1a2333daa94fa3877097455283dd148b36f05d9be33bfbf012fc8c5f8aeb902fe9d1acd0859f6573ca30f585697f1264fc7787b559b21ce5a33176bbd8172df09a35f534a8b39c50a23f5bea3b498aae9333c6cb24c984bfe123bd519cd556d8aec77b09d33d4e570a7cc37bd3560be211d037003c8cf96d6ed25a01d550b1042d4cc502956fe10965fa74bda851ff0878d4fabb5099f20d2fb8dc87f16aa109d7bb9c664a6a88b74e62f284447328698f50ee20076c585114984e8bbeed4e52515c3ee9e97a228ce315091e7b2ed5aa4f537ce3bf2fb38f75e212fccd4fcc335af86d64157527e00294d82d823c38e3c478134d68f2be64c0043b496537ada9b1d23b9d6627c49097b2e9d863e86dfb3105499ccb1e5533e549d5622406edd63bbd37493772c',\r\n\r\n  \r\n    async fetchAccessToken() {\r\n      const response = await fetch('https://cors-anywhere.herokuapp.com/https://bkmzenbkmzen.amocrm.ru/oauth2/access_token', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          client_id: this.client_id,\r\n          client_secret: this.client_secret,\r\n          grant_type: 'authorization_code',\r\n          code: this.code,\r\n          redirect_uri: \"https://digitalbankger.github.io/amocrm_integrations/#/\",\r\n        }),\r\n      });\r\n  \r\n      if (!response.ok) {\r\n        throw new Error('Failed to get access token');\r\n      }\r\n  \r\n      const data = await response.json();\r\n  \r\n      this.tokenInfo = {\r\n        access_token: data.access_token,\r\n        refresh_token: data.refresh_token,\r\n        expires_in: data.expires_in,\r\n        token_type: data.token_type,\r\n      };\r\n  \r\n      localStorage.setItem('access_token', data.access_token);\r\n      localStorage.setItem('refresh_token', data.refresh_token);\r\n  \r\n      return data.access_token;\r\n    },\r\n  \r\n    getStoredAccessToken() {\r\n      return localStorage.getItem('access_token');\r\n    },\r\n  \r\n    async ensureTokenIsValid() {\r\n      const token = this.getStoredAccessToken();\r\n      if (!token) {\r\n        return await this.fetchAccessToken();\r\n      }\r\n  \r\n      return token;\r\n    },\r\n};\r\n\r\nexport default tokenService;\r\n      ","import tokenService from '@/services/tokenService';\r\n\r\nconst baseUrl = 'https://cors-anywhere.herokuapp.com/https://bkmzenbkmzen.amocrm.ru/api';\r\n\r\nasync function fetchData(endpoint, options = {}) {\r\n  const accessToken = await tokenService.ensureTokenIsValid();\r\n\r\n  options.headers = {\r\n    ...options.headers,\r\n    Authorization: `Bearer ${accessToken}`,\r\n    'Content-Type': 'application/json',\r\n  };\r\n\r\n  const response = await fetch(`${baseUrl}${endpoint}`, options);\r\n\r\n  if (!response.ok) {\r\n    throw new Error(`Ошибка: ${response.statusText}`);\r\n  }\r\n\r\n  const contentType = response.headers.get('Content-Type');\r\n\r\n  if (contentType && contentType.includes('application/json')) {\r\n    return await response.json();\r\n  } else {\r\n    return await response.text();\r\n  }\r\n}\r\n\r\n// Получаю все сделки\r\nexport function fetchDeals() {\r\n  return fetchData(`/v4/leads`)\r\n    .then(response => {\r\n      console.log('Ответ от API (сделки):', response); \r\n      return response;\r\n    })\r\n    .catch(error => {\r\n      console.error('Ошибка при получении сделок:', error); \r\n    });\r\n}\r\n\r\n// Получаю сделку по ID\r\nexport function fetchDealById(id) {\r\n  return fetchData(`/v4/leads/${id}`);\r\n}\r\n\r\nexport function useApi() {\r\n  return {\r\n    fetchDeals,\r\n    fetchDealById,\r\n  };\r\n}\r\n","import { render } from \"./ArchiveItems.vue?vue&type=template&id=2b41d767&scoped=true\"\nimport script from \"./ArchiveItems.vue?vue&type=script&lang=js\"\nexport * from \"./ArchiveItems.vue?vue&type=script&lang=js\"\n\nimport \"./ArchiveItems.vue?vue&type=style&index=0&id=2b41d767&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2b41d767\"]])\n\nexport default __exports__","import { render } from \"./CatalogItems.vue?vue&type=template&id=7e89f78e\"\nimport script from \"./CatalogItems.vue?vue&type=script&lang=js\"\nexport * from \"./CatalogItems.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_createVNode","_component_ArchiveItems","_hoisted_4","_hoisted_5","_hoisted_6","_component_StatisticsForm","_hoisted_7","$setup","deals","length","_Fragment","_renderList","deal","key","id","src","alt","_toDisplayString","name","price","tokenService","client_id","client_secret","grant_type","refresh_token","redirect_uri","code","fetchAccessToken","response","fetch","method","headers","body","JSON","stringify","this","ok","Error","data","json","tokenInfo","access_token","expires_in","token_type","localStorage","setItem","getStoredAccessToken","getItem","ensureTokenIsValid","token","baseUrl","async","fetchData","endpoint","options","accessToken","Authorization","statusText","contentType","get","includes","text","fetchDeals","then","console","log","catch","error","fetchDealById","useApi","setup","ref","fetchItems","_embedded","leads","value","onMounted","__exports__","components","ArchiveItems","isLightboxOpen","lightboxImageSrc","openLightbox","imageSrc","closeLightbox","render"],"sourceRoot":""}